<... OMITTED FOR BREVITY (USING FINAL USER-PROVIDED CODE FROM CANVAS) ...>